<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TODO List</title>
  <style>
    *,
    *::before,
    *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg: #ffffff;
      --surface: #f8f9fa;
      --border: #e8e8e8;
      --border-hover: #d0d0d0;
      --text: #1a1a1a;
      --text-muted: #999;
      --accent: #111;
      --accent-hover: #333;
      --green: #10b981;
      --red: #ef4444;
      --red-hover: #dc2626;
      --radius: 12px;
      --shadow: 0 1px 3px rgba(0,0,0,0.04), 0 1px 2px rgba(0,0,0,0.06);
      --shadow-hover: 0 4px 12px rgba(0,0,0,0.06);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 4rem 1.5rem;
    }

    .app {
      width: 100%;
      max-width: 520px;
    }

    /* Header */
    .header {
      margin-bottom: 2.5rem;
    }

    .header h1 {
      font-size: 1.5rem;
      font-weight: 800;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      margin-bottom: 0.25rem;
    }

    .header p {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    /* Input */
    .input-row {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
    }

    .input-row input {
      flex: 1;
      padding: 0.75rem 1rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      color: var(--text);
      font-size: 0.9rem;
      outline: none;
      transition: border-color 0.2s, box-shadow 0.2s;
      box-shadow: var(--shadow);
    }

    .input-row input::placeholder {
      color: var(--text-muted);
    }

    .input-row input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(0,0,0,0.05);
    }

    .btn-add {
      padding: 0.75rem 1.5rem;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: var(--radius);
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      white-space: nowrap;
      letter-spacing: 0.03em;
      transition: background 0.2s, transform 0.15s;
      box-shadow: var(--shadow);
    }

    .btn-add:hover {
      background: var(--accent-hover);
      transform: translateY(-1px);
    }

    /* Filters */
    .filters {
      display: flex;
      gap: 0.25rem;
      margin-bottom: 1rem;
      background: var(--surface);
      border-radius: var(--radius);
      padding: 0.25rem;
    }

    .filters button {
      flex: 1;
      padding: 0.5rem;
      background: transparent;
      border: none;
      border-radius: 8px;
      color: var(--text-muted);
      font-size: 0.8rem;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }

    .filters button.active {
      background: var(--accent);
      color: #fff;
    }

    /* List */
    .todo-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .todo-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.875rem 1rem;
      background: #fff;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      transition: border-color 0.2s, box-shadow 0.2s;
      box-shadow: var(--shadow);
    }

    .todo-item:hover {
      border-color: var(--border-hover);
      box-shadow: var(--shadow-hover);
    }

    /* Checkbox */
    .checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-hover);
      border-radius: 50%;
      cursor: pointer;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s, border-color 0.2s;
    }

    .checkbox:hover {
      border-color: var(--accent);
    }

    .todo-item.done .checkbox {
      background: var(--accent);
      border-color: var(--accent);
    }

    .checkbox svg {
      width: 12px;
      height: 12px;
      stroke: #fff;
      stroke-width: 3;
      fill: none;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .todo-item.done .checkbox svg {
      opacity: 1;
    }

    /* Text */
    .todo-text {
      flex: 1;
      font-size: 0.9rem;
      transition: color 0.2s;
    }

    .todo-item.done .todo-text {
      color: var(--text-muted);
      text-decoration: line-through;
    }

    /* Delete */
    .btn-delete {
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      padding: 0.25rem;
      border-radius: 6px;
      display: flex;
      opacity: 0;
      transition: opacity 0.2s, color 0.2s;
    }

    .todo-item:hover .btn-delete {
      opacity: 1;
    }

    .btn-delete:hover {
      color: var(--red);
    }

    .btn-delete svg {
      width: 16px;
      height: 16px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
    }

    /* Empty */
    .empty {
      text-align: center;
      color: var(--text-muted);
      font-size: 0.85rem;
      padding: 3rem 1rem;
    }

    /* Counter */
    .counter {
      text-align: center;
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 1.5rem;
    }
  </style>
</head>
<body>

  <div class="app">
    <div class="header">
      <h1>TODO</h1>
      <p id="date"></p>
    </div>

    <form class="input-row" id="form">
      <input type="text" id="input" placeholder="新しいタスクを入力..." autocomplete="off">
      <button type="submit" class="btn-add">追加</button>
    </form>

    <div class="filters" id="filters">
      <button class="active" data-filter="all">すべて</button>
      <button data-filter="active">未完了</button>
      <button data-filter="done">完了済み</button>
    </div>

    <ul class="todo-list" id="list"></ul>
    <p class="counter" id="counter"></p>
  </div>

  <script>
    const STORAGE_KEY = "todos";
    let todos = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
    let filter = "all";

    const $ = (s) => document.querySelector(s);
    const form = $("#form");
    const input = $("#input");
    const list = $("#list");
    const counter = $("#counter");
    const filtersEl = $("#filters");

    // Date
    $("#date").textContent = new Date().toLocaleDateString("ja-JP", {
      year: "numeric", month: "long", day: "numeric", weekday: "short"
    });

    function save() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(todos));
    }

    function render() {
      const filtered = todos.filter((t) => {
        if (filter === "active") return !t.done;
        if (filter === "done") return t.done;
        return true;
      });

      if (filtered.length === 0) {
        list.innerHTML = `<li class="empty">${
          filter === "done" ? "完了したタスクはありません" :
          filter === "active" ? "すべて完了しました！" :
          "タスクを追加しましょう"
        }</li>`;
      } else {
        list.innerHTML = filtered.map((t) => `
          <li class="todo-item${t.done ? " done" : ""}" data-id="${t.id}">
            <div class="checkbox" data-action="toggle">
              <svg viewBox="0 0 24 24"><polyline points="4 12 10 18 20 6"/></svg>
            </div>
            <span class="todo-text">${escapeHtml(t.text)}</span>
            <button class="btn-delete" data-action="delete" title="削除">
              <svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
          </li>
        `).join("");
      }

      const active = todos.filter((t) => !t.done).length;
      const done = todos.filter((t) => t.done).length;
      counter.textContent = todos.length > 0
        ? `${active} 件の未完了 / ${done} 件の完了`
        : "";
    }

    function escapeHtml(str) {
      const d = document.createElement("div");
      d.textContent = str;
      return d.innerHTML;
    }

    // Add
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const text = input.value.trim();
      if (!text) return;
      todos.unshift({ id: Date.now().toString(), text, done: false });
      input.value = "";
      save();
      render();
    });

    // Toggle / Delete
    list.addEventListener("click", (e) => {
      const action = e.target.closest("[data-action]");
      if (!action) return;
      const id = action.closest(".todo-item")?.dataset.id;
      if (!id) return;

      if (action.dataset.action === "toggle") {
        const todo = todos.find((t) => t.id === id);
        if (todo) todo.done = !todo.done;
      } else if (action.dataset.action === "delete") {
        todos = todos.filter((t) => t.id !== id);
      }
      save();
      render();
    });

    // Filter
    filtersEl.addEventListener("click", (e) => {
      const btn = e.target.closest("button[data-filter]");
      if (!btn) return;
      filter = btn.dataset.filter;
      filtersEl.querySelectorAll("button").forEach((b) => b.classList.remove("active"));
      btn.classList.add("active");
      render();
    });

    render();
  </script>

</body>
</html>
